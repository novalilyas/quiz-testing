<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QuizMaster Pro</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="2" fill="white" opacity="0.1"/></svg>');
        animation: float 20s linear infinite;
        pointer-events: none;
      }

      @keyframes float {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-100px);
        }
      }

      .page {
        display: none;
        animation: fadeIn 0.5s ease;
      }

      .page.active {
        display: block;
      }

      /* LOGIN PAGE */
      .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .login-box {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        padding: 50px 40px;
        border-radius: 30px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 420px;
        width: 100%;
        text-align: center;
        animation: slideUp 0.6s ease;
      }

      .logo {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 40px;
        margin: 0 auto 20px;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
      }

      .login-box h1 {
        color: #2c3e50;
        font-size: 32px;
        margin-bottom: 10px;
        font-weight: 700;
      }

      .login-box p {
        color: #7f8c8d;
        margin-bottom: 30px;
        font-size: 15px;
      }

      .input-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .input-group label {
        display: block;
        color: #2c3e50;
        font-weight: 600;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .input-group input {
        width: 100%;
        padding: 15px 20px;
        border: 2px solid #e8ecf1;
        border-radius: 12px;
        font-size: 16px;
        transition: all 0.3s;
        background: white;
      }

      .input-group input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
      }

      .btn-primary {
        width: 100%;
        padding: 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
      }

      .btn-primary:active {
        transform: translateY(0);
      }

      /* DASHBOARD */
      .dashboard {
        max-width: 1200px;
        margin: 0 auto;
        padding: 30px 20px;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
        background: rgba(255, 255, 255, 0.95);
        padding: 20px 30px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .avatar {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        font-weight: 700;
        color: white;
      }

      .user-details h3 {
        color: #2c3e50;
        font-size: 18px;
        font-weight: 600;
      }

      .user-details p {
        color: #7f8c8d;
        font-size: 14px;
      }

      .btn-logout {
        padding: 10px 20px;
        background: #f5576c;
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .btn-logout:hover {
        background: #e74c5f;
        transform: translateY(-2px);
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.95);
        padding: 25px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        text-align: center;
        transition: transform 0.3s;
      }

      .stat-card:hover {
        transform: translateY(-5px);
      }

      .stat-icon {
        font-size: 40px;
        margin-bottom: 10px;
      }

      .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 5px;
      }

      .stat-label {
        color: #7f8c8d;
        font-size: 14px;
      }

      .main-content {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 30px;
      }

      .quiz-section {
        background: rgba(255, 255, 255, 0.95);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .quiz-section h2 {
        color: #2c3e50;
        font-size: 28px;
        margin-bottom: 20px;
        font-weight: 700;
      }

      .quiz-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 30px;
        border-radius: 20px;
        color: white;
        margin-bottom: 20px;
      }

      .quiz-card h3 {
        font-size: 24px;
        margin-bottom: 15px;
      }

      .quiz-info {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
        font-size: 14px;
      }

      .quiz-info span {
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 15px;
        border-radius: 10px;
      }

      .btn-start {
        background: white;
        color: #667eea;
        padding: 14px 30px;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s;
      }

      .btn-start:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3);
      }

      .leaderboard-section {
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        max-height: 600px;
      }

      .leaderboard-section h2 {
        color: #2c3e50;
        font-size: 24px;
        margin-bottom: 20px;
        font-weight: 700;
      }

      .leaderboard-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 12px;
        margin-bottom: 10px;
        transition: all 0.3s;
      }

      .leaderboard-item:hover {
        background: #e9ecef;
        transform: translateX(5px);
      }

      .rank-badge {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        font-weight: 700;
        font-size: 18px;
      }

      .rank-1 {
        background: linear-gradient(135deg, #ffd700, #ffed4e);
        color: #333;
      }
      .rank-2 {
        background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
        color: #333;
      }
      .rank-3 {
        background: linear-gradient(135deg, #cd7f32, #daa520);
        color: white;
      }
      .rank-other {
        background: #667eea;
        color: white;
      }

      .player-info {
        flex: 1;
      }

      .player-name {
        font-weight: 600;
        color: #2c3e50;
        font-size: 16px;
      }

      .player-stats {
        font-size: 13px;
        color: #7f8c8d;
      }

      .player-score {
        font-size: 20px;
        font-weight: 700;
        color: #667eea;
      }

      /* QUIZ PAGE */
      .quiz-container {
        max-width: 800px;
        margin: 40px auto;
        padding: 20px;
      }

      .quiz-box {
        background: rgba(255, 255, 255, 0.95);
        padding: 40px;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      }

      .quiz-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #e8ecf1;
      }

      .timer {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 28px;
        font-weight: 700;
        color: #667eea;
      }

      .timer.warning {
        color: #f5576c;
        animation: pulse 1s infinite;
      }

      .progress-bar {
        height: 10px;
        background: #e8ecf1;
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 30px;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea, #764ba2);
        transition: width 0.3s ease;
      }

      .question {
        font-size: 24px;
        color: #2c3e50;
        font-weight: 600;
        margin-bottom: 30px;
        line-height: 1.5;
      }

      .option {
        padding: 20px 25px;
        border: 3px solid #e8ecf1;
        border-radius: 15px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s;
        background: white;
        font-size: 16px;
        position: relative;
      }

      .option:hover {
        border-color: #667eea;
        transform: translateX(10px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.2);
      }

      .option.correct {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        border-color: #11998e;
        animation: correctAnim 0.5s ease;
      }

      .option.wrong {
        background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
        color: white;
        border-color: #eb3349;
        animation: wrongAnim 0.5s ease;
      }

      .option.disabled {
        pointer-events: none;
        opacity: 0.7;
      }

      .btn-next {
        width: 100%;
        padding: 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 15px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 20px;
        display: none;
        transition: all 0.3s;
      }

      .btn-next:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      /* RESULTS PAGE */
      .results-container {
        max-width: 700px;
        margin: 40px auto;
        padding: 20px;
      }

      .results-box {
        background: rgba(255, 255, 255, 0.95);
        padding: 50px 40px;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        text-align: center;
      }

      .results-box h2 {
        color: #2c3e50;
        font-size: 36px;
        margin-bottom: 30px;
      }

      .score-circle {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin: 0 auto 30px;
        box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
      }

      .score-circle h3 {
        color: white;
        font-size: 60px;
        font-weight: 700;
      }

      .score-circle p {
        color: rgba(255, 255, 255, 0.9);
        font-size: 16px;
      }

      .results-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 30px;
      }

      .result-stat {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 15px;
      }

      .result-stat-value {
        font-size: 28px;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 5px;
      }

      .result-stat-label {
        font-size: 14px;
        color: #7f8c8d;
      }

      .btn-secondary {
        padding: 14px 30px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        margin: 10px;
        transition: all 0.3s;
      }

      .btn-secondary:hover {
        background: #5568d3;
        transform: translateY(-2px);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes correctAnim {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes wrongAnim {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
      }

      @media (max-width: 768px) {
        .main-content {
          grid-template-columns: 1fr;
        }

        .stats-grid {
          grid-template-columns: 1fr 1fr;
        }
      }
    </style>
  </head>
  <body>
    <!-- LOGIN PAGE -->
    <div class="page active" id="loginPage">
      <div class="login-container">
        <div class="login-box">
          <div class="logo">üéØ</div>
          <h1>QuizMaster Pro</h1>
          <p>Login untuk memulai tantangan quiz!</p>

          <div class="input-group">
            <label>Username</label>
            <input
              type="text"
              id="usernameInput"
              placeholder="Masukkan username"
              maxlength="20"
            />
          </div>

          <div class="input-group">
            <label>Email</label>
            <input type="email" id="emailInput" placeholder="Masukkan email" />
          </div>

          <button class="btn-primary" onclick="login()">
            üöÄ Mulai Petualangan
          </button>
        </div>
      </div>
    </div>

    <!-- DASHBOARD PAGE -->
    <div class="page" id="dashboardPage">
      <div class="dashboard">
        <div class="header">
          <div class="user-info">
            <div class="avatar" id="userAvatar">A</div>
            <div class="user-details">
              <h3 id="userName">User</h3>
              <p id="userEmail">user@email.com</p>
            </div>
          </div>
          <button class="btn-logout" onclick="logout()">Logout</button>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">üèÜ</div>
            <div class="stat-value" id="totalQuizzes">0</div>
            <div class="stat-label">Quiz Selesai</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">‚≠ê</div>
            <div class="stat-value" id="avgScore">0%</div>
            <div class="stat-label">Rata-rata Skor</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üéñÔ∏è</div>
            <div class="stat-value" id="userRank">-</div>
            <div class="stat-label">Peringkat</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-value" id="bestScore">0%</div>
            <div class="stat-label">Skor Terbaik</div>
          </div>
        </div>

        <div class="main-content">
          <div class="quiz-section">
            <h2>üéÆ Mulai Quiz</h2>
            <div class="quiz-card">
              <h3>General Knowledge Quiz</h3>
              <div class="quiz-info">
                <span>üìù 10 Pertanyaan</span>
                <span>‚è±Ô∏è 30 detik/soal</span>
                <span>üéØ Level: Medium</span>
              </div>
              <button class="btn-start" onclick="startQuiz()">
                Mulai Quiz Sekarang ‚Üí
              </button>
            </div>
          </div>

          <div class="leaderboard-section">
            <h2>üèÜ Leaderboard</h2>
            <div id="leaderboardList"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- QUIZ PAGE -->
    <div class="page" id="quizPage">
      <div class="quiz-container">
        <div class="quiz-box">
          <div class="quiz-header">
            <div>
              <span style="color: #7f8c8d; font-size: 16px">
                Pertanyaan <span id="currentQ">1</span>/<span id="totalQ"
                  >10</span
                >
              </span>
            </div>
            <div class="timer" id="timer">
              ‚è±Ô∏è <span id="timeLeft">30</span>s
            </div>
          </div>

          <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
          </div>

          <div class="question" id="question"></div>
          <div id="options"></div>
          <button class="btn-next" id="nextBtn" onclick="nextQuestion()">
            Lanjut ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- RESULTS PAGE -->
    <div class="page" id="resultsPage">
      <div class="results-container">
        <div class="results-box">
          <h2>üéâ Quiz Selesai!</h2>

          <div class="score-circle">
            <h3 id="finalScore">0%</h3>
            <p id="scoreMessage">Bagus!</p>
          </div>

          <div class="results-stats">
            <div class="result-stat">
              <div class="result-stat-value" id="correctAnswers">0</div>
              <div class="result-stat-label">Benar</div>
            </div>
            <div class="result-stat">
              <div class="result-stat-value" id="wrongAnswers">0</div>
              <div class="result-stat-label">Salah</div>
            </div>
            <div class="result-stat">
              <div class="result-stat-value" id="totalTime">0s</div>
              <div class="result-stat-label">Total Waktu</div>
            </div>
          </div>

          <button class="btn-secondary" onclick="backToDashboard()">
            üìä Lihat Dashboard
          </button>
          <button class="btn-secondary" onclick="startQuiz()">
            üîÑ Main Lagi
          </button>
        </div>
      </div>
    </div>

    <script>
      const quizData = [
        {
          question: "Apa kepanjangan dari HTML?",
          options: [
            "Hyper Text Markup Language",
            "High Tech Modern Language",
            "Home Tool Markup Language",
            "Hyperlinks Text Making Language"
          ],
          answer: 0
        },
        {
          question: "CSS digunakan untuk?",
          options: [
            "Membuat database",
            "Styling halaman web",
            "Membuat server",
            "Membuat aplikasi desktop"
          ],
          answer: 1
        },
        {
          question: "JavaScript pertama kali dibuat oleh?",
          options: [
            "Bill Gates",
            "Brendan Eich",
            "Mark Zuckerberg",
            "Steve Jobs"
          ],
          answer: 1
        },
        {
          question: "Apa fungsi dari tag <img> di HTML?",
          options: [
            "Membuat link",
            "Menampilkan gambar",
            "Membuat tabel",
            "Membuat form"
          ],
          answer: 1
        },
        {
          question: "Mana yang bukan termasuk tipe data di JavaScript?",
          options: ["String", "Boolean", "Float", "Undefined"],
          answer: 2
        },
        {
          question: "Apa kepanjangan dari JSON?",
          options: [
            "JavaScript Object Notation",
            "Java Standard Object Naming",
            "JavaScript Oriented Network",
            "Java Simple Object Notation"
          ],
          answer: 0
        },
        {
          question: "Tag HTML untuk membuat list tidak berurutan?",
          options: ["<ol>", "<ul>", "<li>", "<list>"],
          answer: 1
        },
        {
          question: "Method JavaScript untuk menampilkan alert?",
          options: ["msg()", "alert()", "message()", "popup()"],
          answer: 1
        },
        {
          question: "Apa fungsi dari 'display: flex' di CSS?",
          options: [
            "Membuat animasi",
            "Membuat layout flexible",
            "Menghapus element",
            "Membuat border"
          ],
          answer: 1
        },
        {
          question: "HTTP adalah singkatan dari?",
          options: [
            "Hyper Text Transfer Protocol",
            "High Transfer Text Protocol",
            "Home Text Transfer Protocol",
            "Hyperlink Transfer Text Protocol"
          ],
          answer: 0
        }
      ];

      let currentUser = null;
      let quiz = [];
      let currentQuestion = 0;
      let score = 0;
      let wrongAnswers = 0;
      let timeLeft = 30;
      let timerInterval;
      let startTime;
      let totalTimeTaken = 0;

      // Login Function
      function login() {
        const username = document.getElementById("usernameInput").value.trim();
        const email = document.getElementById("emailInput").value.trim();

        if (!username || !email) {
          alert("Mohon isi username dan email!");
          return;
        }

        if (!email.includes("@")) {
          alert("Format email tidak valid!");
          return;
        }

        currentUser = {
          username: username,
          email: email,
          loginTime: new Date().toISOString()
        };

        showPage("dashboardPage");
        updateDashboard();
      }

      // Logout Function
      function logout() {
        currentUser = null;
        document.getElementById("usernameInput").value = "";
        document.getElementById("emailInput").value = "";
        showPage("loginPage");
      }

      // Show Page
      function showPage(pageId) {
        document.querySelectorAll(".page").forEach((page) => {
          page.classList.remove("active");
        });
        document.getElementById(pageId).classList.add("active");
      }

      // Update Dashboard
      function updateDashboard() {
        if (!currentUser) return;

        // Update user info
        document.getElementById("userName").textContent = currentUser.username;
        document.getElementById("userEmail").textContent = currentUser.email;
        document.getElementById("userAvatar").textContent = currentUser.username
          .charAt(0)
          .toUpperCase();

        // Get user stats
        const allScores = JSON.parse(
          localStorage.getItem("quizScores") || "[]"
        );
        const userScores = allScores.filter(
          (s) => s.username === currentUser.username
        );

        const totalQuizzes = userScores.length;
        const avgScore =
          totalQuizzes > 0
            ? Math.round(
                userScores.reduce((sum, s) => sum + s.percentage, 0) /
                  totalQuizzes
              )
            : 0;
        const bestScore =
          totalQuizzes > 0
            ? Math.max(...userScores.map((s) => s.percentage))
            : 0;

        document.getElementById("totalQuizzes").textContent = totalQuizzes;
        document.getElementById("avgScore").textContent = avgScore + "%";
        document.getElementById("bestScore").textContent = bestScore + "%";

        // Calculate rank
        const leaderboard = calculateLeaderboard();
        const userRankIndex = leaderboard.findIndex(
          (p) => p.username === currentUser.username
        );
        document.getElementById("userRank").textContent =
          userRankIndex >= 0 ? "#" + (userRankIndex + 1) : "-";

        // Update leaderboard
        displayLeaderboard();
      }

      // Calculate Leaderboard
      function calculateLeaderboard() {
        const allScores = JSON.parse(
          localStorage.getItem("quizScores") || "[]"
        );
        const players = {};

        allScores.forEach((score) => {
          if (!players[score.username]) {
            players[score.username] = {
              username: score.username,
              totalQuizzes: 0,
              totalScore: 0,
              bestScore: 0,
              totalTime: 0
            };
          }

          players[score.username].totalQuizzes++;
          players[score.username].totalScore += score.percentage;
          players[score.username].bestScore = Math.max(
            players[score.username].bestScore,
            score.percentage
          );
          players[score.username].totalTime += score.time;
        });

        return Object.values(players).sort((a, b) => b.bestScore - a.bestScore);
      }

      // DISPLAY LEADERBOARD
      function displayLeaderboard() {
        const leaderboard = calculateLeaderboard();
        const list = document.getElementById("leaderboardList");
        list.innerHTML = "";

        leaderboard.forEach((player, index) => {
          const rankClass =
            index === 0
              ? "rank-1"
              : index === 1
              ? "rank-2"
              : index === 2
              ? "rank-3"
              : "rank-other";

          const item = `
                    <div class="leaderboard-item">
                        <div class="rank-badge ${rankClass}">${index + 1}</div>
                        <div class="player-info">
                            <div class="player-name">${player.username}</div>
                            <div class="player-stats">
                                ${player.totalQuizzes}x main ‚Ä¢ Best: ${
            player.bestScore
          }%
                            </div>
                        </div>
                        <div class="player-score">${player.bestScore}%</div>
                    </div>
                `;
          list.innerHTML += item;
        });
      }

      // START QUIZ
      function startQuiz() {
        quiz = quizData;
        currentQuestion = 0;
        score = 0;
        wrongAnswers = 0;
        totalTimeTaken = 0;

        showPage("quizPage");
        loadQuestion();
      }

      // LOAD QUESTION
      function loadQuestion() {
        const q = quiz[currentQuestion];

        document.getElementById("question").textContent = q.question;
        document.getElementById("currentQ").textContent = currentQuestion + 1;
        document.getElementById("totalQ").textContent = quiz.length;

        const optionsBox = document.getElementById("options");
        optionsBox.innerHTML = "";

        q.options.forEach((opt, i) => {
          const div = document.createElement("div");
          div.className = "option";
          div.textContent = opt;
          div.onclick = () => selectOption(i);
          optionsBox.appendChild(div);
        });

        startTimer();
        updateProgress();
      }

      // TIMER
      function startTimer() {
        timeLeft = 30;
        document.getElementById("timeLeft").textContent = timeLeft;
        document.getElementById("timer").classList.remove("warning");

        clearInterval(timerInterval);
        startTime = Date.now();

        timerInterval = setInterval(() => {
          timeLeft--;
          document.getElementById("timeLeft").textContent = timeLeft;

          if (timeLeft <= 10) {
            document.getElementById("timer").classList.add("warning");
          }

          if (timeLeft === 0) {
            clearInterval(timerInterval);
            wrongAnswers++;
            nextQuestion();
          }
        }, 1000);
      }

      // SELECT OPTION
      function selectOption(i) {
        clearInterval(timerInterval);

        const options = document.querySelectorAll(".option");
        const correct = quiz[currentQuestion].answer;

        options.forEach((opt) => opt.classList.add("disabled"));

        if (i === correct) {
          options[i].classList.add("correct");
          score++;
        } else {
          options[i].classList.add("wrong");
          options[correct].classList.add("correct");
          wrongAnswers++;
        }

        document.getElementById("nextBtn").style.display = "block";

        const timeSpent = Math.floor((Date.now() - startTime) / 1000);
        totalTimeTaken += timeSpent;
      }

      // NEXT QUESTION
      function nextQuestion() {
        document.getElementById("nextBtn").style.display = "none";

        currentQuestion++;
        if (currentQuestion >= quiz.length) {
          finishQuiz();
        } else {
          loadQuestion();
        }
      }

      // FINISH QUIZ
      function finishQuiz() {
        showPage("resultsPage");

        const percentage = Math.round((score / quiz.length) * 100);

        document.getElementById("finalScore").textContent = percentage + "%";
        document.getElementById("correctAnswers").textContent = score;
        document.getElementById("wrongAnswers").textContent = wrongAnswers;
        document.getElementById("totalTime").textContent = totalTimeTaken + "s";

        document.getElementById("scoreMessage").textContent =
          percentage >= 80
            ? "üî• Luar Biasa!"
            : percentage >= 60
            ? "Bagus!"
            : "Tetap Semangat!";

        // SAVE SCORE TO LOCAL STORAGE
        const allScores = JSON.parse(
          localStorage.getItem("quizScores") || "[]"
        );

        allScores.push({
          username: currentUser.username,
          percentage: percentage,
          time: totalTimeTaken
        });

        localStorage.setItem("quizScores", JSON.stringify(allScores));
        updateDashboard();
      }

      function updateProgress() {
        const fill = document.getElementById("progressBar");
        const percent = (currentQuestion / quiz.length) * 100;
        fill.style.width = percent + "%";
      }

      function backToDashboard() {
        showPage("dashboardPage");
        updateDashboard();
      }
    </script>
  </body>
</html>
