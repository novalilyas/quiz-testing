<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz App Advanced</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        min-height: 100vh;
      }

      .center {
        text-align: center;
        padding: 80px 20px;
        animation: fadeIn 0.8s ease;
      }

      h1 {
        font-size: 48px;
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .start-btn,
      .restart-btn {
        padding: 16px 40px;
        font-size: 20px;
        border-radius: 50px;
        border: none;
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        font-weight: 600;
        margin: 10px;
      }

      .start-btn:hover,
      .restart-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
      }

      .container {
        max-width: 700px;
        background: rgba(255, 255, 255, 0.95);
        margin: 40px auto;
        padding: 35px;
        border-radius: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        display: none;
        animation: slideUp 0.6s ease;
        color: #333;
      }

      .quiz-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #e0e0e0;
      }

      .timer {
        font-size: 28px;
        font-weight: bold;
        color: #667eea;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .timer.warning {
        color: #f5576c;
        animation: pulse 1s infinite;
      }

      .progress-bar {
        width: 100%;
        height: 8px;
        background: #e0e0e0;
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 25px;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea, #764ba2);
        transition: width 0.3s ease;
      }

      #question {
        font-size: 24px;
        margin-bottom: 25px;
        color: #2c3e50;
        font-weight: 600;
        line-height: 1.5;
      }

      .option {
        padding: 16px 20px;
        border: 2px solid #e0e0e0;
        border-radius: 15px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s;
        background: white;
        position: relative;
        overflow: hidden;
      }

      .option:hover {
        border-color: #667eea;
        transform: translateX(5px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
      }

      .option.correct {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        border-color: #11998e;
        animation: correctAnim 0.5s ease;
      }

      .option.wrong {
        background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
        color: white;
        border-color: #eb3349;
        animation: wrongAnim 0.5s ease;
      }

      .option.disabled {
        pointer-events: none;
        opacity: 0.6;
      }

      #nextBtn {
        width: 100%;
        margin-top: 25px;
        padding: 14px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 15px;
        color: white;
        cursor: pointer;
        display: none;
        font-size: 18px;
        font-weight: 600;
        transition: all 0.3s;
      }

      #nextBtn:hover {
        transform: scale(1.02);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
      }

      .leaderboard {
        display: none;
        animation: fadeIn 0.8s ease;
      }

      .leaderboard h2 {
        color: #2c3e50;
        margin-bottom: 30px;
        font-size: 32px;
      }

      .score-display {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 20px;
        margin-bottom: 30px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      }

      .score-display h3 {
        font-size: 48px;
        margin-bottom: 10px;
      }

      .name-input {
        width: 100%;
        padding: 15px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        font-size: 16px;
        margin-bottom: 15px;
        transition: border 0.3s;
      }

      .name-input:focus {
        outline: none;
        border-color: #667eea;
      }

      .leaderboard-list {
        background: white;
        border-radius: 15px;
        padding: 20px;
        margin-top: 25px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .leaderboard-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid #e0e0e0;
        transition: background 0.3s;
      }

      .leaderboard-item:last-child {
        border-bottom: none;
      }

      .leaderboard-item:hover {
        background: #f8f9fa;
      }

      .rank {
        font-size: 24px;
        font-weight: bold;
        color: #667eea;
        min-width: 40px;
      }

      .rank.gold {
        color: #ffd700;
      }
      .rank.silver {
        color: #c0c0c0;
      }
      .rank.bronze {
        color: #cd7f32;
      }

      .player-name {
        flex: 1;
        font-weight: 600;
        color: #2c3e50;
      }

      .player-score {
        font-weight: bold;
        color: #667eea;
        font-size: 18px;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin-top: 20px;
      }

      .stat-box {
        background: linear-gradient(
          135deg,
          rgba(102, 126, 234, 0.1) 0%,
          rgba(118, 75, 162, 0.1) 100%
        );
        padding: 15px;
        border-radius: 12px;
        text-align: center;
      }

      .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: #667eea;
      }

      .stat-label {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(40px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes correctAnim {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.03);
        }
      }

      @keyframes wrongAnim {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-5px);
        }
        75% {
          transform: translateX(5px);
        }
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
      }

      .confetti {
        position: fixed;
        width: 10px;
        height: 10px;
        background: #f0f;
        position: absolute;
        animation: confetti-fall 3s linear forwards;
      }

      @keyframes confetti-fall {
        to {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <!-- START PAGE -->
    <div class="center" id="startPage">
      <h1>üéØ Quiz Challenge!</h1>
      <p style="font-size: 20px; margin-bottom: 30px">
        Uji pengetahuanmu dan raih skor tertinggi!
      </p>
      <button class="start-btn" onclick="startQuiz()">üöÄ Mulai Quiz</button>
    </div>

    <!-- QUIZ PAGE -->
    <div class="container" id="quizBox">
      <div class="quiz-header">
        <div>
          <span style="color: #666; font-size: 14px"
            >Pertanyaan <span id="currentQ">1</span>/<span id="totalQ"
              >10</span
            ></span
          >
        </div>
        <div class="timer" id="timer">‚è±Ô∏è <span id="timeLeft">30</span>s</div>
      </div>

      <div class="progress-bar">
        <div class="progress-fill" id="progressBar"></div>
      </div>

      <h2 id="question"></h2>
      <div id="options"></div>
      <button id="nextBtn" onclick="nextQuestion()">Lanjut ‚Üí</button>
    </div>

    <!-- LEADERBOARD PAGE -->
    <div class="container leaderboard" id="leaderboardPage">
      <h2>üèÜ Quiz Selesai!</h2>

      <div class="score-display">
        <h3 id="finalScore">0</h3>
        <p style="font-size: 18px" id="scoreMessage"></p>

        <div class="stats">
          <div class="stat-box">
            <div class="stat-value" id="correctAnswers">0</div>
            <div class="stat-label">Benar</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="wrongAnswers">0</div>
            <div class="stat-label">Salah</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="totalTime">0s</div>
            <div class="stat-label">Waktu</div>
          </div>
        </div>
      </div>

      <input
        type="text"
        class="name-input"
        id="playerName"
        placeholder="Masukkan nama kamu..."
        maxlength="20"
      />
      <button class="start-btn" onclick="saveScore()">üíæ Simpan Skor</button>

      <div class="leaderboard-list" id="leaderboardList"></div>

      <button class="restart-btn" onclick="restartQuiz()">üîÑ Main Lagi</button>
    </div>

    <audio
      id="correctSound"
      src="data:audio/wav;base64,UklGRhIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQA="
      preload="auto"
    ></audio>
    <audio
      id="wrongSound"
      src="data:audio/wav;base64,UklGRhIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQA="
      preload="auto"
    ></audio>

    <script>
      const quizData = [
        {
          question: "Apa kepanjangan dari HTML?",
          options: [
            "Hyper Text Markup Language",
            "High Tech Modern Language",
            "Home Tool Markup Language",
            "Hyperlinks Text Making Language"
          ],
          answer: 0
        },
        {
          question: "CSS digunakan untuk?",
          options: [
            "Membuat database",
            "Styling halaman web",
            "Membuat server",
            "Membuat aplikasi desktop"
          ],
          answer: 1
        },
        {
          question: "JavaScript pertama kali dibuat oleh?",
          options: [
            "Bill Gates",
            "Brendan Eich",
            "Mark Zuckerberg",
            "Steve Jobs"
          ],
          answer: 1
        },
        {
          question: "Apa fungsi dari tag <img> di HTML?",
          options: [
            "Membuat link",
            "Menampilkan gambar",
            "Membuat tabel",
            "Membuat form"
          ],
          answer: 1
        },
        {
          question: "Mana yang bukan termasuk tipe data di JavaScript?",
          options: ["String", "Boolean", "Float", "Undefined"],
          answer: 2
        },
        {
          question: "Apa kepanjangan dari JSON?",
          options: [
            "JavaScript Object Notation",
            "Java Standard Object Naming",
            "JavaScript Oriented Network",
            "Java Simple Object Notation"
          ],
          answer: 0
        },
        {
          question: "Tag HTML untuk membuat list tidak berurutan?",
          options: ["<ol>", "<ul>", "<li>", "<list>"],
          answer: 1
        },
        {
          question: "Method JavaScript untuk menampilkan alert?",
          options: ["msg()", "alert()", "message()", "popup()"],
          answer: 1
        },
        {
          question: "Apa fungsi dari 'display: flex' di CSS?",
          options: [
            "Membuat animasi",
            "Membuat layout flexible",
            "Menghapus element",
            "Membuat border"
          ],
          answer: 1
        },
        {
          question: "HTTP adalah singkatan dari?",
          options: [
            "Hyper Text Transfer Protocol",
            "High Transfer Text Protocol",
            "Home Text Transfer Protocol",
            "Hyperlink Transfer Text Protocol"
          ],
          answer: 0
        },
        {
          question: "Apa fungsi dari localStorage di JavaScript?",
          options: [
            "Menyimpan data di server",
            "Menyimpan data di browser",
            "Menghapus cookies",
            "Membuat database"
          ],
          answer: 1
        },
        {
          question: "Tag HTML untuk membuat hyperlink?",
          options: ["<link>", "<a>", "<href>", "<url>"],
          answer: 1
        },
        {
          question:
            "Selector CSS untuk memilih semua element dengan class 'container'?",
          options: ["#container", ".container", "container", "*container"],
          answer: 1
        },
        {
          question: "Operator JavaScript untuk perbandingan strict equal?",
          options: ["==", "=", "===", "!="],
          answer: 2
        },
        {
          question: "Framework JavaScript yang dikembangkan oleh Facebook?",
          options: ["Angular", "Vue", "React", "Svelte"],
          answer: 2
        }
      ];

      let quiz = [];
      let currentQuestion = 0;
      let score = 0;
      let wrongAnswers = 0;
      let timeLeft = 30;
      let timerInterval;
      let startTime;
      let totalTimeTaken = 0;

      function shuffleArray(array) {
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
      }

      function startQuiz() {
        quiz = shuffleArray(quizData).slice(0, 10);
        currentQuestion = 0;
        score = 0;
        wrongAnswers = 0;
        totalTimeTaken = 0;
        startTime = Date.now();

        document.getElementById("startPage").style.display = "none";
        document.getElementById("quizBox").style.display = "block";
        document.getElementById("totalQ").textContent = quiz.length;

        loadQuestion();
      }

      function loadQuestion() {
        if (currentQuestion >= quiz.length) {
          finishQuiz();
          return;
        }

        timeLeft = 30;
        document.getElementById("timer").classList.remove("warning");
        startTimer();

        const q = quiz[currentQuestion];
        document.getElementById("currentQ").textContent = currentQuestion + 1;
        document.getElementById("question").textContent = q.question;

        const progress = (currentQuestion / quiz.length) * 100;
        document.getElementById("progressBar").style.width = progress + "%";

        let optHTML = "";
        q.options.forEach((opt, i) => {
          optHTML += `<div class='option' onclick='selectAnswer(${i})'>${opt}</div>`;
        });

        document.getElementById("options").innerHTML = optHTML;
        document.getElementById("nextBtn").style.display = "none";
      }

      function startTimer() {
        clearInterval(timerInterval);
        document.getElementById("timeLeft").textContent = timeLeft;

        timerInterval = setInterval(() => {
          timeLeft--;
          document.getElementById("timeLeft").textContent = timeLeft;

          if (timeLeft <= 10) {
            document.getElementById("timer").classList.add("warning");
          }

          if (timeLeft <= 0) {
            clearInterval(timerInterval);
            autoSelectWrong();
          }
        }, 1000);
      }

      function autoSelectWrong() {
        wrongAnswers++;
        const opts = document.querySelectorAll(".option");
        const correctIndex = quiz[currentQuestion].answer;

        opts.forEach((opt, index) => {
          opt.classList.add("disabled");
          if (index === correctIndex) {
            opt.classList.add("correct");
          }
        });

        document.getElementById("nextBtn").style.display = "block";
      }

      function selectAnswer(selectedIndex) {
        clearInterval(timerInterval);

        const correctIndex = quiz[currentQuestion].answer;
        const opts = document.querySelectorAll(".option");

        opts.forEach((opt, index) => {
          opt.classList.add("disabled");
          if (index === correctIndex) {
            opt.classList.add("correct");
          }
          if (index === selectedIndex && selectedIndex !== correctIndex) {
            opt.classList.add("wrong");
          }
        });

        if (selectedIndex === correctIndex) {
          score++;
          playSound(true);
        } else {
          wrongAnswers++;
          playSound(false);
        }

        document.getElementById("nextBtn").style.display = "block";
      }

      function playSound(isCorrect) {
        // Simplified sound - using Web Audio API
        const audioContext = new (window.AudioContext ||
          window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        if (isCorrect) {
          oscillator.frequency.value = 800;
          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            audioContext.currentTime + 0.5
          );
        } else {
          oscillator.frequency.value = 200;
          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            audioContext.currentTime + 0.3
          );
        }

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
      }

      function nextQuestion() {
        currentQuestion++;
        loadQuestion();
      }

      function finishQuiz() {
        clearInterval(timerInterval);
        totalTimeTaken = Math.floor((Date.now() - startTime) / 1000);

        document.getElementById("quizBox").style.display = "none";
        document.getElementById("leaderboardPage").style.display = "block";

        const percentage = Math.round((score / quiz.length) * 100);
        document.getElementById("finalScore").textContent = percentage + "%";
        document.getElementById("correctAnswers").textContent = score;
        document.getElementById("wrongAnswers").textContent = wrongAnswers;
        document.getElementById("totalTime").textContent = totalTimeTaken + "s";

        let message = "";
        if (percentage === 100) {
          message = "üéâ Sempurna! Kamu luar biasa!";
          createConfetti();
        } else if (percentage >= 80) {
          message = "üåü Hebat! Skor yang bagus!";
        } else if (percentage >= 60) {
          message = "üëç Bagus! Terus tingkatkan!";
        } else {
          message = "üí™ Jangan menyerah! Coba lagi!";
        }
        document.getElementById("scoreMessage").textContent = message;

        displayLeaderboard();
      }

      function createConfetti() {
        for (let i = 0; i < 50; i++) {
          setTimeout(() => {
            const confetti = document.createElement("div");
            confetti.className = "confetti";
            confetti.style.left = Math.random() * 100 + "%";
            confetti.style.background = `hsl(${Math.random() * 360}, 70%, 60%)`;
            confetti.style.animationDelay = Math.random() * 0.5 + "s";
            document.body.appendChild(confetti);
            setTimeout(() => confetti.remove(), 3000);
          }, i * 30);
        }
      }

      function saveScore() {
        const name = document.getElementById("playerName").value.trim();
        if (!name) {
          alert("Masukkan nama kamu dulu!");
          return;
        }

        let leaderboard = JSON.parse(
          localStorage.getItem("quizLeaderboard") || "[]"
        );

        leaderboard.push({
          name: name,
          score: score,
          total: quiz.length,
          percentage: Math.round((score / quiz.length) * 100),
          time: totalTimeTaken,
          date: new Date().toLocaleDateString()
        });

        leaderboard.sort((a, b) => {
          if (b.percentage !== a.percentage) return b.percentage - a.percentage;
          return a.time - b.time;
        });

        leaderboard = leaderboard.slice(0, 10);
        localStorage.setItem("quizLeaderboard", JSON.stringify(leaderboard));

        document.getElementById("playerName").value = "";
        displayLeaderboard();
      }

      function displayLeaderboard() {
        const leaderboard = JSON.parse(
          localStorage.getItem("quizLeaderboard") || "[]"
        );
        const listEl = document.getElementById("leaderboardList");

        if (leaderboard.length === 0) {
          listEl.innerHTML =
            "<p style='text-align: center; color: #999; padding: 20px;'>Belum ada data leaderboard</p>";
          return;
        }

        let html =
          "<h3 style='color: #2c3e50; margin-bottom: 15px;'>üèÖ Top Players</h3>";
        leaderboard.forEach((player, index) => {
          let rankClass = "";
          let medal = "";
          if (index === 0) {
            rankClass = "gold";
            medal = "ü•á";
          } else if (index === 1) {
            rankClass = "silver";
            medal = "ü•à";
          } else if (index === 2) {
            rankClass = "bronze";
            medal = "ü•â";
          }

          html += `
            <div class="leaderboard-item">
              <span class="rank ${rankClass}">${medal || index + 1}</span>
              <span class="player-name">${player.name}</span>
              <span class="player-score">${player.percentage}% (${
            player.time
          }s)</span>
            </div>
          `;
        });

        listEl.innerHTML = html;
      }

      function restartQuiz() {
        document.getElementById("leaderboardPage").style.display = "none";
        document.getElementById("startPage").style.display = "block";
      }

      // Load leaderboard on page load
      window.addEventListener("load", () => {
        displayLeaderboard();
      });
    </script>
  </body>
</html>
